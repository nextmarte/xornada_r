---
title: "FII_portfolio_opt_R"
bibliography: Xornada_resumo.bib
format: docx
always_allow_html: true
editor: visual
author: "Marcus Antonio Cardoso Ramalho"
---

```{r}
#| packages, echo = FALSE, warning = FALSE, mesage = FALSE

library(tidyverse)
library(lubridate)
library(tidyquant)
library(tibbletime)
library(quantmod)
library(PerformanceAnalytics)
library(plotly)
library(readxl)


#loading data
selic<-readxl::read_xlsx("dados/historico_selic.xlsx")
ifix<-readxl::read_xlsx("dados/Retornos_ifix.xlsx")

ret_comb<-rbind(selic,ifix)
  

```

### Context

This work is part of Marcus Ramalho undeargraduation final project in administration on Universidade Federal Fluminense, entitled: Análise de risco e rentabilidade de uma carteira de fundos de investimento imobiliário.

This part of the project is focused on a method of optimization for a portfolio. The code itself, from the data aquisition to the optmization was adapted from various sources and built using the knowledge aquired by the student during the first covid-19 pandemic year when Dr. Ariel Levy offered a remote course on finance with R for administration students.

To better understand this project first we need to present some simple concepts about FII's and risk in finance. FII's or Fundos de Investimento Imobiliário are a booming tipe of real state investment in Brazil, there was more than one milion investor in 2020 , in their majority small investor, comparing with 2010 when there was less than fifty thousand investors, the growth of the market is notable. The appeal of this investment is related to the changes in the Brazilian economy after 2016. With the lowest basic interest rate ever, market players saw in FII's an opportunity to earn more when compared to risk-free investments, with a lower risk compared to other equity assets.

```{r}
#| Graph_1, echo = FALSE, warning = FALSE

 (ifix_selic<-plot_ly(ret_comb,x = ~date, y = ~returns, type='scatter',mode='lines', color = ~asset, width = 500, height = 400) %>% 
   layout(title="IFIX vs SELIC returns - jan/2017-dec/2019"))
  
```

### Risk

### Purpose

This project aimed to simulate an optimize a FII portfolio considering the scenario of low brazilian economy basic interest rate and accelerated real state market growing, focusing on some market indicators such as:

the covariance and the standard deviation to measure volatility and risk.

Sharpe index, witch measures the adjusted profitability ($P_r$) for the total portfolio risk (σ) , compared with a minimum accepted return ($M_r$).

$$ SI=\frac{\overline{P_r}-M_r}{\sigma_{p}} $$ {#eq-Sharpe}

$\beta$, witch measures the portfolio sensibility to an specified market, in this case the IFIX was used as reference.$$\beta=\frac{Cov(P;IFIX)}{\sigma_{IFIX}^2}$$

### Metodology

This work relied on the use of RStudio and various R packages to manipulate and understand the data, including: Tydiverse[@wickham2019] ,Lubridade[@grolemund2011]for general data manipulation, plotly[@sievert] and ggplot2[@wickham2016] for data visualization and quantmode[@ryan2022], tidyquant[@dancho2022] and PerformanceAnalitycs[@peterson2020] for financial data vesting, manipulation and computation.

For the assets selection some assumptions were made. Using a filter tool from the website Clube do FII[@clubefii], all assets with the IPO (Inicial public offering) prior the year of 2017 and mean monthly liquidity greater than R\$ 2,000.00 were selected.

The chosen assets price data was downloaded within the time window of 2017 to 2019 with the package quantmod[@ryan2022a] and Yahoo Finance[@yahoofi] as source. After the price data vesting, followed the monthly log returns calculation using dplyr[@wickham2022] and xts[@ryan2020] to transform the daily returns in monthly returns. All funds with inconsistent data and no participation on the market index (IFIX) were discarded at this phase and 24 assets were selected at the end.

A sample weight vector was created to start the simulations and optimization with the selected portfolio, the optimization itself was made adapting a script from codingfinance.com[@codingf2018] and was achieved calculating the portfolio returns using weights generated with the base function runif[@rcoreteam2022]witch uses uniform distribution.

three indicators were calculated for each simulation with the portfolio returns results to measure risk, market sensibility and the Sharpe Index

### Results

### Conclusion
